<!DOCTYPE html><html lang="en"><head><title>Earth Invader</title><script>function SfxrParams(){this.setSettings=function(e){for(var t=0;t<24;t++){this[String.fromCharCode(97+t)]=e[t]||0}if(this["c"]<.01){this["c"]=.01}var n=this["b"]+this["c"]+this["e"];if(n<.18){var r=.18/n;this["b"]*=r;this["c"]*=r;this["e"]*=r}}}function SfxrSynth(){this._params=new SfxrParams;var e,t,n,r,i,s,o,u,a,f,l,c;this.reset=function(){var e=this._params;r=100/(e["f"]*e["f"]+.001);i=100/(e["g"]*e["g"]+.001);s=1-e["h"]*e["h"]*e["h"]*.01;o=-e["i"]*e["i"]*e["i"]*1e-6;if(!e["a"]){l=.5-e["n"]/2;c=-e["o"]*5e-5}u=1+e["l"]*e["l"]*(e["l"]>0?-.9:10);a=0;f=e["m"]==1?0:(1-e["m"])*(1-e["m"])*2e4+32};this.totalReset=function(){this.reset();var r=this._params;e=r["b"]*r["b"]*1e5;t=r["c"]*r["c"]*1e5;n=r["e"]*r["e"]*1e5+12;return((e+t+n)/3|0)*3};this.synthWave=function(h,p){var d=this._params;var v=d["s"]!=1||d["v"],m=d["v"]*d["v"]*.1,g=1+d["w"]*3e-4,y=d["s"]*d["s"]*d["s"]*.1,b=1+d["t"]*1e-4,w=d["s"]!=1,E=d["x"]*d["x"],S=d["g"],x=d["q"]||d["r"],T=d["r"]*d["r"]*d["r"]*.2,N=d["q"]*d["q"]*(d["q"]<0?-1020:1020),C=d["p"]?((1-d["p"])*(1-d["p"])*2e4|0)+32:0,k=d["d"],L=d["j"]/2,A=d["k"]*d["k"]*.01,O=d["a"];var M=e,_=1/e,D=1/t,P=1/n;var H=5/(1+d["u"]*d["u"]*20)*(.01+y);if(H>.8){H=.8}H=1-H;var B=false,j=0,F=0,I=0,q=0,R=0,U,z=0,W,X=0,V,$=0,J,K=0,Q,G,Y=0;var Z=new Array(1024),et=new Array(32);for(var tt=Z.length;tt--;){Z[tt]=0}for(var tt=et.length;tt--;){et[tt]=Math.random()*2-1}for(var tt=0;tt<p;tt++){if(B){return tt}if(C){if(++K>=C){K=0;this.reset()}}if(f){if(++a>=f){f=0;r*=u}}s+=o;r*=s;if(r>i){r=i;if(S>0){B=true}}W=r;if(L>0){Y+=A;W*=1+Math.sin(Y)*L}W|=0;if(W<8){W=8}if(!O){l+=c;if(l<0){l=0}else if(l>.5){l=.5}}if(++F>M){F=0;switch(++j){case 1:M=t;break;case 2:M=n}}switch(j){case 0:I=F*_;break;case 1:I=1+(1-F*D)*2*k;break;case 2:I=1-F*P;break;case 3:I=0;B=true}if(x){N+=T;V=N|0;if(V<0){V=-V}else if(V>1023){V=1023}}if(v&&g){m*=g;if(m<1e-5){m=1e-5}else if(m>.1){m=.1}}G=0;for(var nt=8;nt--;){X++;if(X>=W){X%=W;if(O==3){for(var rt=et.length;rt--;){et[rt]=Math.random()*2-1}}}switch(O){case 0:Q=X/W<l?.5:-.5;break;case 1:Q=1-X/W*2;break;case 2:J=X/W;J=(J>.5?J-1:J)*6.28318531;Q=1.27323954*J+.405284735*J*J*(J<0?1:-1);Q=.225*((Q<0?-1:1)*Q*Q-Q)+Q;break;case 3:Q=et[Math.abs(X*32/W|0)]}if(v){U=z;y*=b;if(y<0){y=0}else if(y>.1){y=.1}if(w){R+=(Q-z)*y;R*=H}else{z=Q;R=0}z+=R;q+=z-U;q*=1-m;Q=q}if(x){Z[$%1024]=Q;Q+=Z[($-V+1024)%1024];$++}G+=Q}G*=.125*I*E;h[tt]=G>=1?32767:G<=-1?-32768:G*32767|0}return p}}var synth=new SfxrSynth;window["jsfxr"]=function(e){synth._params.setSettings(e);var t=synth.totalReset();var n=new Uint8Array(((t+1)/2|0)*4+44);var r=synth.synthWave(new Uint16Array(n.buffer,44),t)*2;var i=new Uint32Array(n.buffer,0,44);i[0]=1179011410;i[1]=r+36;i[2]=1163280727;i[3]=544501094;i[4]=16;i[5]=65537;i[6]=44100;i[7]=88200;i[8]=1048578;i[9]=1635017060;i[10]=r;r+=44;var s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="data:audio/wav;base64,";for(;s<r;s+=3){var a=n[s]<<16|n[s+1]<<8|n[s+2];u+=o[a>>18]+o[a>>12&63]+o[a>>6&63]+o[a&63]}return u}function distance(e,t,n,r){dX2=Math.pow(n-e,2);dY2=Math.pow(r-t,2);return Math.sqrt(dX2+dY2)}function collision(e,t){space=e.radius+t.radius;if(distance(e.x,e.y,t.x,t.y)<space){return true}else{return false}}function initMainMenu(){initStars();var e=document.getElementById("mainmenu");currentcanvas="mm";var t=e.getContext("2d");winwidth=document.documentElement.clientWidth;winheight=document.documentElement.clientHeight;e.width=winwidth;e.height=winheight;renderops.main=true;e.addEventListener("mousemove",function(t){var n=e.getBoundingClientRect();mouseX=t.clientX-n.left;mouseY=t.clientY-n.top},false);var n=[];n.push({color:"red",width:200,height:75,top:winheight/2+50,left:winwidth/2-100});e.addEventListener("click",function(r){var s=e.offsetLeft;var o=e.offsetTop;var u=r.pageX-s;var a=r.pageY-o;n.forEach(function(n){if(a>n.top&&a<n.top+n.height&&u>n.left&&u<n.left+n.width){t.clearRect(0,0,e.width,e.height);renderops.main=false;i();var r=new Audio;r.src=jsfxr(sounds.click);r.play();r.addEventListener("ended",function(){delete r},false);initLevelSelect()}})},false);var r=function(){if(renderops.main){s();requestAnimationFrame(r)}};var i=function(){t.clearRect(0,0,e.width,e.height)};var s=function(){i();t.font="30pt Arial";t.fillStyle="white";t.textAlign="center";t.fillText("Earth Invader",winwidth/2,50);n.forEach(function(e){t.fillStyle=e.color;t.fillRect(e.left,e.top,e.width,e.height)});t.fillStyle="black";t.fillText("Start",winwidth/2,winheight/2+100);var e="#";for(var r=0;r<3;r++){e+=(Math.floor(Math.random()*200)+55).toString(16)}t.fillStyle=e;t.fillRect(mouseX+1,mouseY+4,2,8);t.fillRect(mouseX+4,mouseY+1,8,2);t.fillRect(mouseX+1,mouseY-8,2,8);t.fillRect(mouseX-8,mouseY+1,8,2)};r()}function initLevelSelect(){var e=document.getElementById("levelselect");currentcanvas="ls";var t=e.getContext("2d");winwidth=document.documentElement.clientWidth;winheight=document.documentElement.clientHeight;e.width=winwidth;e.height=winheight;renderops.levelselect=true;var n="";e.addEventListener("click",function(n){var r=e.offsetLeft;var s=e.offsetTop;var o=n.pageX-r;var u=n.pageY-s;if(u>e.height-150&&u<e.height-150+75&&o>e.width/2-100&&o<e.width/2-100+200){t.clearRect(0,0,e.width,e.height);renderops.levelselect=false;i();var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false);initGame()}if(u>200&&u<275&&o>e.width/4/2+100&&o<e.width/4/2+100+200){Options.planType="fire";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}if(u>200&&u<275&&o>e.width/2-250&&o<e.width/2-250+200){Options.planType="air";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}if(u>200&&u<275&&o>e.width/2+50&&o<e.width/2+50+200){Options.planType="water";var a=new Audio;a.src=jsfxr(sounds.click);a.play()}if(u>200&&u<275&&o>e.width/2+50+(e.width/2-250)-(e.width/4/2+100)&&o<e.width/2+50+(e.width/2-250)-(e.width/4/2+100)+200){Options.planType="rock";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}if(u>400&&u<475&&o>e.width/4/2+100&&o<e.width/4/2+100+200){Options.wepType="fire";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}if(u>400&&u<475&&o>e.width/2-250&&o<e.width/2-250+200){Options.wepType="air";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}if(u>400&&u<475&&o>e.width/2+50&&o<e.width/2+50+200){Options.wepType="water";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}if(u>400&&u<475&&o>e.width/2+50+(e.width/2-250)-(e.width/4/2+100)&&o<e.width/2+50+(e.width/2-250)-(e.width/4/2+100)+200){Options.wepType="rock";var a=new Audio;a.src=jsfxr(sounds.click);a.play();a.addEventListener("ended",function(){delete a},false)}},false);e.addEventListener("mousemove",function(t){var r=e.getBoundingClientRect();x=t.clientX-r.left;y=t.clientY-r.top;mouseX=t.clientX-r.left;mouseY=t.clientY-r.top;if(y>200&&y<275&&x>e.width/4/2+100&&x<e.width/4/2+100+200){n="Weak against Air, resistant to Water."}else if(y>200&&y<275&&x>e.width/2-250&&x<e.width/2-250+200){n="Weak against Rock, resistant to Fire."}else if(y>200&&y<275&&x>e.width/2+50&&x<e.width/2+50+200){n="Weak against Fire, resistant to Rock."}else if(y>200&&y<275&&x>e.width/2+50+(e.width/2-250)-(e.width/4/2+100)&&x<e.width/2+50+(e.width/2-250)-(e.width/4/2+100)+200){n="Weak against Water, resistant to Air."}else if(y>400&&y<475&&x>e.width/4/2+100&&x<e.width/4/2+100+200){n="Effective against Water, less effective against Air."}else if(y>400&&y<475&&x>e.width/2-250&&x<e.width/2-250+200){n="Effective against Fire, less effective against Rock."}else if(y>400&&y<475&&x>e.width/2+50&&x<e.width/2+50+200){n="Effective against Rock, less effective against Fire."}else if(y>400&&y<475&&x>e.width/2+50+(e.width/2-250)-(e.width/4/2+100)&&x<e.width/2+50+(e.width/2-250)-(e.width/4/2+100)+200){n="Effective against Air, less effective against Water."}else{n=""}});var r=function(){if(renderops.levelselect){s();requestAnimationFrame(r)}};var i=function(){t.clearRect(0,0,e.width,e.height)};var s=function(){i();t.font="30pt Arial";t.fillStyle="white";t.textAlign="center";t.fillText("Level Select",winwidth/2,50);t.fillStyle="green";t.fillRect(e.width/2-100,e.height-150,200,75);t.fillStyle="black";t.fillText("Play",winwidth/2,winheight-100);t.font="20pt Arial";t.fillStyle="white";t.textAlign="center";t.fillText("Select a Planet Type",winwidth/2,150);t.fillStyle="red";t.fillRect(e.width/4/2+100,200,200,75);t.fillStyle="black";t.fillText("Fire",e.width/4/2+200,250);if(Options.planType==="fire"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.fillStyle="white";t.fillRect(e.width/2-250,200,200,75);t.fillStyle="black";t.fillText("Air",e.width/2-150,250);if(Options.planType==="air"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.fillStyle="blue";t.fillRect(e.width/2+50,200,200,75);t.fillStyle="black";t.fillText("Water",e.width/2+150,250);if(Options.planType==="water"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.fillStyle="brown";t.fillRect(e.width/2+50+(e.width/2-250)-(e.width/4/2+100),200,200,75);t.fillStyle="black";t.fillText("Rock",e.width/2+50+(e.width/2-250)-(e.width/4/2+100)+100,250);if(Options.planType==="rock"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.font="20pt Arial";t.fillStyle="white";t.textAlign="center";t.fillText("Select a Weapon Type",winwidth/2,350);t.fillStyle="red";t.fillRect(e.width/4/2+100,400,200,75);t.fillStyle="black";t.fillText("Fire",e.width/4/2+200,450);if(Options.wepType==="fire"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.fillStyle="white";t.fillRect(e.width/2-250,400,200,75);t.fillStyle="black";t.fillText("Air",e.width/2-150,450);if(Options.wepType==="air"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.fillStyle="blue";t.fillRect(e.width/2+50,400,200,75);t.fillStyle="black";t.fillText("Water",e.width/2+150,450);if(Options.wepType==="water"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.fillStyle="brown";t.fillRect(e.width/2+50+(e.width/2-250)-(e.width/4/2+100),400,200,75);t.fillStyle="black";t.fillText("Rock",e.width/2+50+(e.width/2-250)-(e.width/4/2+100)+100,450);if(Options.wepType==="rock"){t.strokeStyle==planTraits[Options.planType].planstroke;t.stroke()}t.font="20pt Arial";t.fillStyle="white";t.textAlign="center";t.fillText(n,winwidth/2,525);var r="#";for(var s=0;s<3;s++){r+=(Math.floor(Math.random()*200)+55).toString(16)}t.fillStyle=r;t.fillRect(mouseX+1,mouseY+4,2,8);t.fillRect(mouseX+4,mouseY+1,8,2);t.fillRect(mouseX+1,mouseY-8,2,8);t.fillRect(mouseX-8,mouseY+1,8,2)};r()}function initStars(){var e=document.getElementById("stars");var t=e.getContext("2d");var n=document.documentElement.clientWidth;var r=document.documentElement.clientHeight;e.width=n;e.height=r;var i=[];var s=["blue","white","red","yellow"];for(var o=0;o<r;o+=Math.round(Math.random()*100)+1){for(var u=0;u<n;u+=Math.round(Math.random()*100)+1){var a=s[Math.round(Math.random()*4)];var f=new Star(u,o,a);i.push(f)}}for(var u=0;u<n;u+=Math.round(Math.random()*100)+1){for(var o=0;o<r;o+=Math.round(Math.random()*100)+1){var a=s[Math.round(Math.random()*4)];var f=new Star(u,o,a);i.push(f)}}render=function(){i.forEach(function(e){e.draw(t)})};render()}function initGame(){var e=document.createElement("canvas");e.id="game";document.body.appendChild(e);var t=document.getElementById("game");var n=t.getContext("2d");currentcanvas="gc";var r=document.documentElement.clientWidth;var i=document.documentElement.clientHeight;t.width=r;t.height=i;var s=t.width/2;var o=t.height/2;var u=false;var a=false;if(Options.planType==="fire"){if(Options.wepType==="fire"){scoremult=1}else if(Options.wepType==="air"){scoremult=.5}else if(Options.wepType==="water"){scoremult=1.5}else if(Options.wepType==="rock"){scoremult=1}}else if(Options.planType==="air"){if(Options.wepType==="fire"){scoremult=1.5}else if(Options.wepType==="air"){scoremult=1}else if(Options.wepType==="water"){scoremult=1}else if(Options.wepType==="rock"){scoremult=.5}}else if(Options.planType==="water"){if(Options.wepType==="fire"){scoremult=.5}else if(Options.wepType==="air"){scoremult=1}else if(Options.wepType==="water"){scoremult=1}else if(Options.wepType==="rock"){scoremult=1.5}}else if(Options.planType==="rock"){if(Options.wepType==="fire"){scoremult=1}else if(Options.wepType==="air"){scoremult=1.5}else if(Options.wepType==="water"){scoremult=.5}else if(Options.wepType==="rock"){scoremult=1}}var f=false;var l=false;var c=0;var h=[];var p=[];var d=[];var v=[];var m=[];var g=new Planet(s,o,"Planet",planTraits[Options.planType].plancolor,planTraits[Options.planType].planstroke,h);var y=new Healthbar(r-310,10,g,false);var b=new Turret(s,45,"Player",[d,v],p);var w=new Healthbar(10,10,b,false);var E=[[40,40],[40,o],[40,i],[s,40],[s,i],[r-40,40],[r-40,o],[r-40,i-40]];var S=["fire","air","water","rock"];var x=1;var T=1;var N=function(e,t,n){var r=Math.round(Math.random()*20)+60;var i=new Enemy(e,t,10,10,r,n,h,p,false);i.assignplayer(b);d.push(i);if(x<7){setTimeout(function(){N(e,t,n)},1e3);x+=1}};var C=function(e,t,n){var r=Math.round(Math.random()*20)+60;var i=new Enemy(e,t,30,30,r,n,h,p,true);i.assignplayer(b);var s=new Healthbar(e,t,i,true);m.push(s);d.push(i)};var k=function(e,t,n){var r=Math.round(Math.random()*20)+80;var i=new Enemy(e,t,10,10,r,n,h,p,false);i.assignplayer(g);v.push(i);if(T<14){setTimeout(function(){k(e,t,n)},1e3);T+=1}};N(s,o+100,Options.planType);k(r/2-40,i/2-40,Options.planType);t.addEventListener("mousedown",function(e){f=true},false);t.addEventListener("mouseup",function(e){f=false},false);t.addEventListener("mousemove",function(e){var n=t.getBoundingClientRect();mouseX=e.clientX-n.left;mouseY=e.clientY-n.top},false);window.addEventListener("keydown",function(e){keysDown[e.keyCode]=true},false);window.addEventListener("keyup",function(e){delete keysDown[e.keyCode]},false);var L=function(){var e=Date.now();var t=e-D;if(!u){A(t/1e3);M()}else if(u&&a){_(true)}else if(u&&!a){_(false)}D=e;requestAnimationFrame(L)};var A=function(e){if(f){c++;if(c%wepTraits[Options.wepType].rof==1){var n=mouseX-b.x;var s=mouseY-b.y;var o=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));var l=new Bullet(b.x,b.y,3,n/o,s/o,wepTraits[Options.wepType].speed,wepTraits[Options.wepType].damage,wepTraits[Options.wepType].color,Options.wepType,b,true);if(Options.wepType==="air"){var L=new Bullet(b.x,b.y,3,(n-150)/o,s/o,wepTraits[Options.wepType].speed,wepTraits[Options.wepType].damage,wepTraits[Options.wepType].color,Options.wepType,b,true);var A=new Bullet(b.x,b.y,3,n/o,(s-150)/o,wepTraits[Options.wepType].speed,wepTraits[Options.wepType].damage,wepTraits[Options.wepType].color,Options.wepType,b,true);var O=new Bullet(b.x,b.y,3,(n-100)/o,s/o,wepTraits[Options.wepType].speed,wepTraits[Options.wepType].damage,wepTraits[Options.wepType].color,Options.wepType,b,true);var M=new Bullet(b.x,b.y,3,n/o,(s-100)/o,wepTraits[Options.wepType].speed,wepTraits[Options.wepType].damage,wepTraits[Options.wepType].color,Options.wepType,b,true);h.push(L);h.push(A);h.push(O);h.push(M)}var _=new Audio;_.src=jsfxr(sounds.player[Options.wepType]);_.play();_.addEventListener("ended",function(){delete _},false);h.push(l)}}d.forEach(function(e){e.update(g)});v.forEach(function(e){e.update(g)});h.forEach(function(e){e.update(h)});p.forEach(function(e){e.update(p)});m.forEach(function(e){e.update()});b.update(e,t);w.update();y.update();g.update();if((Date.now()-H)/1e3>15){H=Date.now();if(d.length<100){x=1;var D=Math.floor(Math.random()*8);N(E[D][0],E[D][1],S[Math.floor(Math.random()*4)])}if(v.length<14){T=15-v.length;k(r/2-40,i/2-40,Options.planType)}}if((Date.now()-B)/1e3>60){B=Date.now();var D=Math.floor(Math.random()*8);C(E[D][0],E[D][1],S[Math.floor(Math.random()*4)])}if(g.health<=0){u=true;a=true}if(b.health<=0){b.alive=false;u=true}time=Math.floor((Date.now()-P)/1e3);score=Math.round(enemiesKilled*g.totaldamage/time*10*scoremult)};var O=function(){n.clearRect(0,0,t.width,t.height)};var M=function(){O();g.draw(n);d.forEach(function(e){e.draw(n,d)});v.forEach(function(e){e.draw(n,v)});m.forEach(function(e){e.draw(n)});w.draw(n);y.draw(n);n.font="20pt Arial";n.fillStyle="white";n.textAlign="center";n.fillText(time,winwidth/2,30);b.draw(n);h.forEach(function(e){e.draw(n)});p.forEach(function(e){e.draw(n)});var e="#";for(var t=0;t<3;t++){e+=(Math.floor(Math.random()*200)+55).toString(16)}n.fillStyle=e;n.fillRect(mouseX+1,mouseY+4,2,8);n.fillRect(mouseX+4,mouseY+1,8,2);n.fillRect(mouseX+1,mouseY-10,2,8);n.fillRect(mouseX-10,mouseY+1,8,2)};var _=function(e){O();n.font="100pt Impact";if(e){n.fillStyle="green";n.textAlign="center";n.fillText("You Win!",winwidth/2,winheight/2)}else if(!e){n.fillStyle="red";n.textAlign="center";n.fillText("Game Over!",winwidth/2,winheight/2)}n.font="75pt Impact";n.fillText("Score: "+score,winwidth/2,winheight/2+110);n.font="30pt Impact";n.fillText("Time: "+time+" seconds",winwidth/2,winheight/2+150);n.fillText("Enemies Killed: "+enemiesKilled,winwidth/2,winheight/2+185);n.font="30pt Arial";n.fillStyle="white";n.textAlign="center";n.fillText("Level Select",winwidth/2,50);n.fillStyle="green";n.fillRect(t.width/2-100,t.height-150,200,75);n.fillStyle="black";n.fillText("Replay",winwidth/2,winheight-100);var r="#";for(var i=0;i<3;i++){r+=(Math.floor(Math.random()*200)+55).toString(16)}n.fillStyle=r;n.fillRect(mouseX+1,mouseY+4,2,8);n.fillRect(mouseX+4,mouseY+1,8,2);n.fillRect(mouseX+1,mouseY-10,2,8);n.fillRect(mouseX-10,mouseY+1,8,2)};t.addEventListener("click",function(r){var i=t.offsetLeft;var s=t.offsetTop;var o=r.pageX-i;var f=r.pageY-s;if(f>t.height-150&&f<t.height-150+75&&o>t.width/2-100&&o<t.width/2-100+200&&u){n.clearRect(0,0,t.width,t.height);u=false;a=false;for(o in d){delete d[o]}for(o in v){delete v[o]}for(o in h){delete h[o]}for(o in p){delete p[o]}for(o in m){delete m[o]}g.alive=false;b.alive=false;renderops.game=false;document.body.removeChild(e);initLevelSelect()}},false);var D=Date.now();var P=Date.now();var H=Date.now();var B=Date.now();L()}function resize(){if(currentcanvas==="mm"){initMainMenu()}else if(currentcanvas==="ls"){initLevelSelect()}else if(currentcanvas==="gc"){initGame()}}var currentcanvas;var keysDown={};var mouseX=0;var mouseY=0;var winheight=0;var winwidth=0;var score=0;var enemiesKilled=0;var time=0;var scoremult=1;var sprite_player=new Image;var sprite_fire=new Image;var sprite_rock=new Image;var sprite_water=new Image;var sprite_air=new Image;var boom_fire=new Image;var boom_rock=new Image;var boom_water=new Image;var boom_air=new Image;sprite_player.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAMAAADzN3VRAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gkGAh069n+LkgAAAhBQTFRF+vr5////AAAABQUFDw4LExEOExIOFBMQFhYRGBcUGBcXGRkZHBsTHh0YHh0bHx4NISAaIyMTJCESJSMhJiUaKCckKyobKyonLCgjLSwrLiwnMC8rMysdMzIvNTQvNjQhOzkaPDo2Pjw2Pz48QD44Qj83Q0A7REI+RUIeRUQzR0IlR0VBSkhETEpATUxGTksdUCcZUU9KU1EkVFFMVUA6VzorV0xIV1VRWSYQWVFHWktAXlRNXlxAX1lUYFwgYV5YY2JZZz4wZ2FYZ2RdaV1ZakU1amdkbC8cbFBEb1ZHcGJacG4ycWc/cW0hdGBZdnNwd2lid2phd3JJeGVfenAVfFI9fHd0fT4qfWBRfWJZfXs9f1hNgDMggX58gyQWg3Nvg3lEhEUxhGlahoSDhz0ni4MgjH1WjIF8jUw1jygLkjYeknpLk4NilUYrlkk4lmxZmDobmJAVm4lInFI8n4RVn5gno4pao4xYpDQbqzcarFxKrUcqrm5Mr5YXr5tUsE81sJBMsj0dskoqui8UvLMRvSgGwJdQxDMRxDobxJtBxZs8xbtBxrNPxsFWyKBNyZw4ykknypM6zsZgz8hG0jUO06Ey08pU081p1cs/2isI285G3NR44DkI4D8T4rMu5EET5z0R6DYJ6DkJ6EUW6T8O7DIE7jgJ70ET8e+/8jwR9CMN9DoH9vTg+fOz+/fW/Pry+p9c2AAAAAJ0Uk5TAAB2k804AAAAAWJLR0QB/wIt3gAAAVpJREFUKM9jYMQFGIiTWYZDZvH8uQsWYJFpyw91dAzPLY5mQJPpy3HSU1VSVzd3i0WVAUoYK0lJq6hp2/onI8u0pTnpyYkI8EgpKWnb+6cjZPqzbZk4uXlEBCTklNSsXIKr4DJFluqc7DwKdvoK8tKmla5meTAZH01ZUV4RjajZ00uNZNynpJikLATJrGQR4uHg4uAQtJu+ZsWsVIu45oKsijkgmVXzZrCxsbGwcgRNWr9uWm1m68wpU6bMWQrWw68lJszFxWvTvW7t5EKDuPbcxMZFUHt6EnTlRPkEQnont+hLxCxs9KheBnNbnZ+hsriAmLevhoSsY0dexAS4q7tKAozVJPm4BYTFFc08vZIQMoz95YHmytzMLNLKOubO/vHI4dZZBpQSkNbRM3cOi0UN66kNwdaWxobGDv6x6PEzsaa+qTrDIzIeS5wuX7Jk/lwc6WA1GWkHBQAAvH1XOkRKwwEAAAAASUVORK5CYII=";sprite_fire.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAOVBMVEUAAAD/ugD/xgD/kwD/vgD/hwD/fQD/6AD/swD/qAD/3AD/nwD/mgD/ggD/lgD/jgD/1QD/0AD/dwAZEj0xAAAAAnRSTlMADH8lgRMAAABiSURBVAgdBcGHAcMgEACxy3c6eP9hIwEw7SYAsHW5vZ4AHjFm2esJxPfFbiWvw4wv/MxRcpPla+w9WxPpfHFUhzYzecy1lquWmVxQPe5lJfcHHrpHK+kJcI42k54AwGiSAH82EAPJABiB9wAAAABJRU5ErkJggg==";sprite_rock.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMBAMAAACkW0HUAAAAKlBMVEUAAACWTBeGQhKKRBOCQBJxOBBtNg+QSBV0OhBfMA59PhF4PBFmMw9IJQ2Rt3ZcAAAAAXRSTlMAQObYZgAAAFlJREFUCNdjYGAQFGQAkUZKhgwMjELaW5QFGBg1wsJWKTCYu+Yc63JnKNp69maEM4NQ6Nybqc4MwkszZ2a7MzC7hh3bosDAqOLR1VTAwCBs4qIOMqbYmIEBAAogE865++QUAAAAAElFTkSuQmCC";sprite_water.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAV1BMVEUAAACE0vuE0vsJgsEUisUJeLELdKoikstCqd4If7w8pds2oNcdj8oQgrwJfLkNe7QwnNMYjMgOhsMUf7d8zvdtxfNbuekyn9cllc8hi8AaiMAypuRPseOwitA1AAAAA3RSTlMAEgSF73AUAAAAa0lEQVQIHQXBhQHDMBAAsUsfzHaY2v3nrMSHzxTqHQCAb1lkTe0BuOIiKt1sADGsKuO9m0O+VMXsPHJziqok3/b9VGdWSebjd0R1iqoks7Zod5irSOpm3YFcwioisjlAjnOtYRsAMMXwPgB/e/QEuuONR8gAAAAASUVORK5CYII=";sprite_air.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAS1BMVEUAAADt7e3o5+e6tLTq6uro5ubv7+/n5ubs7Ozu7u7d2tra19fv7+/Szs7s6+vY1NTp6Ojh3d3n5eXk4eHKxcXFwMC7tbWopKSyrq4u3EvSAAAACXRSTlMANB7+OygEQUBBWsCSAAAAbElEQVQIHRXBhwHDIAwEwAe3qEvgkv0njXMHYP0QpfQVrzaGu4+4GtCzWISz7F6xkSplSYTtIKW/FLMF5C7CEmLXg5zFrzBbHpCSu49iO7/Yk0jVJ9t5o40xSyLClg4ck1l1yrnh1TZVqr0DP+LRBkPdaWJGAAAAAElFTkSuQmCC";boom_fire.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAAilBMVEUAAAD/Pw//Lw//kAP/Qwz/QAz/FxL/fgT/aAb/hgP/Swn/cgX/dwT/UQj/YQb/iwP/ngL/Rwr/Wgf/bQb/dQX/Kw7/Nwz/Sgn/fgD/ExP/Kg//ewP/agX/Pwv/VQj/FxL/YQb/agX/Tgj/FBP/Pwz/HhH/nAH/owL/mAL/qQH/yAD/uQH/sAH/1gAycOBjAAAAJ3RSTlMAAgT+BgsJ/v389/39/Pn+/vv7+PXz8vEcFhH69vT08vDs4y387iQsv7HRAAAAnUlEQVQIHQXBhQHCQBAEwD15jbvgGgH6b48ZQEdWoLsbgCbY16UnGjIC9GIBe4qeY6LQvmIQc57mQ3G0R88ATcypJOWhFQKjqmtqZd1kdYwR5po4WT77Rw4NGxDRLS33374UiX8CoKYov9uyyMRvmOhdK5uTEGZlZPnV3tK1ltydyeAOYAhNHyhmM2AAOoVH543GzEB17M52flRKAP4ZPwpqAq4EtQAAAABJRU5ErkJggg==";boom_rock.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAAbFBMVEV1Xg6ehQ1sVg8AAAChiAyulAyQeA2AaQ+JcQ91XxF5Yg5/aA9oUw9fSRCJcQ2HcA9mUA98ZA5tVxByXBBfShBnUQ9tVw+UfQ5tVw9wWg9nUQ9oUhBfShCMcw+XfQ+FbBCbgwuqjhaylhmfhBJCRDr6AAAAHXRSTlMEAQwADAf+/f79/PUIFBT3/v79+/r59/cb99mBd8UDXQUAAACWSURBVAgdDcEHAsIgEATAXY7e0uwKJPH/f9QZwIBakKApEKiYMpm84WNMGZhHojgrxlkQouaW0BqWDgHIS/Qh9GEhNADLzbnw7S0LgJJLcq4d32Xd3h/c733f+3F2P3yM0Pp6ncN5NM+qK0jFS9v3tkDhT/Tkg7UxqD+ImUat1ujtWZAhLipmS431hQLeHjR1UkatG9QPaPsInqWXDWQAAAAASUVORK5CYII=";boom_water.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAAxlBMVEUAAABCltg6iNIzhdAfXcIiXcM0dcw3jtNCftBDkdYvb8k5ktQqeswkascwiNAvhc8tgM04mtc7jNMphM4sf809ktVBodpDnNgqfcwziNAugs43jtMldskyhdA6l9YofMswjdExfc4aY8Myd8w4idEjbsg6jtM4hdBHsd9MsuArbsk7pNk4htAaY8Mvd8s0l9QibscfZsQ1k9QwcMkxg881i9I5jtMqectIoNpJlddGg9MzjNI8ltZRvuRKtuBOseBHsN9Eqtxc7/LmAAAAO3RSTlMADwkDEAgC/R0VBf37Hv7+/v39/Pbz/v39+fn28/Lw8O7t7amki2VUJh8a/v349vX18O/s4c20oYhIMg6F3XkAAACuSURBVAgdBcEFAsIwAASwq8vccBju7tBh//8UCWADIe2lRyFBOWh6WgrW9wQwLzjoSI2NPFZA0Cs0pL63ZmanKO/Xxwyckau/Sdw0q20NoINgEkerMPutnxBoN1uNKH5/v+mMMII8i8Kk9np9lAvzMyhbDOPf+1NXfl52IcAPlXNVWk2l5YAYeo2b70ZeV4MDE883pHTkkQyIhGnvKZYdZdmiGAgwArB5p6khCbV/ugkQqCbu2aMAAAAASUVORK5CYII=";boom_air.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAAq1BMVEUAAADp4+Px7e3t5ubo4eHa09PVysrv7Ozu5+fm39/z8PDw6enf2dno4+PZ0tLVycnj29vq5OT08/Ps5ubr5ubs6ur+/PzAsLD8+/vAtrb28/PLvr7SysrEtbXPyMjQycnz8fHi3Nzazs7f2tr29PTs6eni39/n4+PNwMC7s7PDsrLr5eXRw8Pq4+PLvr7s6urFtrbp5ubFtLT////18vLr4+Ph2Njq39/d09Mjzk5BAAAANHRSTlMA/v7++vn49AL+/f317u0H+vn19PDeSy0QDwn78fHw6ebk4uHUv7+glIiDZ1RJRzw1Ix8cfDwE3AAAAItJREFUCB0FwQVig0AAALAc7tRt7u5A+/+XLQG+1o9w2PjoC37yG/x1revuc1fs8znbJtl4ytv3w3YZ+85q6PLVbRqit9MAdmkZx2OUDOegf8nKcQynYwavF2fZNEXHKa6i2ZWH1TIJZRhDjF9IQxQPQw3QhEhVV+jxPJsjXbQUXCYNuFsAKOxZ3/MP1sYKW7vFUKgAAAAASUVORK5CYII=";var renderops={main:false,levelselect:false,game:false};var Options={planType:"fire",wepType:"fire"};var sounds={player:{fire:[3,.3758,.0389,.4992,.56,.5291,,,.0115,.1529,.2918,-.2967,-.849,-.2789,,-.3001,-.1337,.4522,.9619,.0049,-.543,.0878,.0741,.5],air:[2,,.242,,.2856,.5935,.2,-.1545,,,,,,.4263,-.3038,,,,1,,,.1972,,.5],water:[3,,.14,.5702,.4047,.97,,,,,,.0856,.7404,,,.4366,,,1,,,,,.5],rock:[2,,.1486,.0618,.0313,.3235,.0103,-.4143,,,,,,.2042,.1735,,,,1,,,,,.5],death:[0,.0344,.2434,7e-4,.6978,.5593,,9e-4,-.1852,.188,,-.8373,.5945,-.8342,-7e-4,,3e-4,-.0709,.9177,-.1776,.7897,,1e-4,.5],hit:[1,,.0125,,.1674,.6682,,-.3997,,,,,,,,,,,1,,,,,.5],shielddown:[3,,.2837,.5598,.4561,.0189,,,,,,,,,,,,,1,,,,,.5],shieldback:[1,.9203,.7129,.2955,.369,.5223,,-.0713,.1758,.7845,.9862,-.968,-.8643,.7915,-.0807,,-.3867,-.0029,.9063,.0015,,.0282,-.0049,.5]},planet:{death:[3,,.2159,.7801,.97,.07,,,,,,,.89,,,,,.32,.79,,.11,.4,-.36,.5],hit:[3,,.0112,,.31,.0875,,-.0122,,,,.422,.8441,,,,.1835,-.0441,1,,,,,.5]},fire:{hit:[2,,.011,,.2299,.6347,.0408,-.4464,.2178,.0469,.0193,.0419,.0302,.0684,.0369,.0177,-.0717,.0732,.9868,-.0122,.0097,.074,-.0184,.5],shoot:[1,,.1636,.2996,.2184,.5588,.2816,-.2181,,,,,,.2688,.0118,,.1677,-.0588,1,,,,,.5],death:[3,,.3766,.2533,.4427,.1865,,-.2766,,,,-.2171,.8871,,,.7384,.5009,-.2509,1,,,,,.5]},air:{hit:[1,,.0536,,.2621,.631,,-.4006,,,,,,,,,,,1,,,,,.5],shoot:[2,,.1136,.1444,.3466,.9639,.2139,-.2432,,,,,,.8125,-.3376,,,,1,,,.2307,,.5],death:[3,,.2042,.2207,.4078,.1535,,.2536,,,,.0739,.7854,,,,-.1692,-.2249,1,,,,,.5]},water:{hit:[1,,.01,,.2682,.7035,,-.367,,,,,,,,,,,1,,,.1467,,.5],shoot:[0,,.3498,,.2535,.3297,,.2893,,,,,,.0596,,,,,.8007,,,.0934,,.5],death:[3,,.3065,.6898,.3659,.042,,.2063,,,,-.6731,.6848,,,,,,1,,,,,.5]},rock:{hit:[3,,.0129,,.28,.2587,,-.5081,,,,,,,,,,,1,,,,,.5],shoot:[2,.0518,.19,.31,.3405,.3398,.0424,-.4251,.0355,.1033,.1365,-.0342,.0407,.0517,-.0559,.0628,.3034,-.2626,1,.0017,.0805,.0027,-.0163,.5],death:[3,,.2477,.2528,.4555,.0385,,.044,,,,-.247,.7443,,,,,,1,,,,,.5]},powerup:{trishot:[0,.0474,.1545,.4804,.518,.4414,.1353,-.0068,.0824,,,-.0384,.0189,.0616,.0708,.115,.0828,.0371,.8901,-.1333,.0065,.0344,.0251,.5]},click:[0,,.1601,,.0198,.586,,,,,,,,.5755,,,,,1,,,.1,,.5]};var planTraits={fire:{plancolor:"#F72A0A",planstroke:"#CF2308"},air:{plancolor:"#DEDEDE",planstroke:"#BFBFBF"},water:{plancolor:"#076DF2",planstroke:"#0658C4"},rock:{plancolor:"#6B4303",planstroke:"#593802"}};var wepTraits={fire:{color:"orange",rof:5,speed:15,damage:5},air:{color:"ghostwhite",rof:50,speed:15,damage:20},water:{color:"deepskyblue",rof:20,speed:20,damage:10},rock:{color:"saddlebrown",rof:30,speed:10,damage:25}};var enemyTraits={fire:{img:sprite_fire,boom:boom_fire,speed:4,rof:20,health:50,damage:10,bulletColor:"orange"},air:{img:sprite_air,boom:boom_air,speed:5,rof:100,health:25,damage:5,bulletColor:"ghostwhite"},water:{img:sprite_water,boom:boom_water,speed:3,rof:100,health:75,damage:15,bulletColor:"deepskyblue"},rock:{img:sprite_rock,boom:boom_rock,speed:2,rof:100,health:100,damage:20,bulletColor:"saddlebrown"}};Enemy=function(e,t,n,r,i,s,o,u,a){this.x=e;this.y=t;this.width=n;this.height=r;this.isboss=a;this.type=s;this.speed=enemyTraits[this.type].speed;this.orbit=i;this.health=enemyTraits[this.type].health;this.damagemult=1;this.rof=enemyTraits[this.type].rof;this.count=0;this.trigger=Math.floor(Math.random()*this.rof);this.pBullets=o;this.eBullets=u;this.radius=this.width*1.2;this.alive=true;this.explode=false;this.rotation=0;if(this.isboss){this.shield=this.health;this.health*=5;this.speed=3}};Enemy.prototype.assignplayer=function(e){this.player=e};Enemy.prototype.update=function(e){if(!(this.player===undefined)&&this.alive){this.count=(this.count+1)%this.rof;this.playerX=this.player.x;this.playerY=this.player.y;var t=this.playerX-this.x;var n=this.playerY-this.y;var r=Math.sqrt(t*t+n*n);t=t/r;n=n/r;this.rotation=Math.atan2(n,t);if(this.count==this.trigger&&this.player.name!=="Planet"){var i=new Bullet(this.x,this.y,3,t,n,8,10,enemyTraits[this.type].bulletColor,Options.planType,this,false);var s=new Audio;s.src=jsfxr(sounds[this.type].shoot);s.play();s.addEventListener("ended",function(){delete s},false);this.eBullets.push(i)}var o=true;if((r>this.orbit+5||this.player.shield<=0)&&this.player!==e){this.angle=Math.atan2(n,t)+Math.PI;this.x+=t*this.speed;this.y+=n*this.speed}else if(r<this.orbit-5){this.angle=Math.atan2(n,t)+Math.PI;this.x-=t*this.speed*2;this.y-=n*this.speed*2}else{this.angle-=.02;this.x=r*Math.cos(this.angle)+this.player.x;this.y=r*Math.sin(this.angle)+this.player.y}for(var u=0;u<this.pBullets.length;u++){if(this.type==="fire"){if(this.pBullets[u].type==="fire"){this.damagemult=1}else if(this.pBullets[u].type==="air"){this.damagemult=1.5}else if(this.pBullets[u].type==="water"){this.damagemult=.5}else if(this.pBullets[u].type==="rock"){this.damagemult=1}}else if(this.type==="air"){if(this.pBullets[u].type==="fire"){this.damagemult=.5}else if(this.pBullets[u].type==="air"){this.damagemult=1}else if(this.pBullets[u].type==="water"){this.damagemult=1}else if(this.pBullets[u].type==="rock"){this.damagemult=1.5}}else if(this.type==="water"){if(this.pBullets[u].type==="fire"){this.damagemult=1.5}else if(this.pBullets[u].type==="air"){this.damagemult=1}else if(this.pBullets[u].type==="water"){this.damagemult=1}else if(this.pBullets[u].type==="rock"){this.damagemult=.5}}else if(this.type==="rock"){if(this.pBullets[u].type==="fire"){this.damagemult=1}else if(this.pBullets[u].type==="air"){this.damagemult=.5}else if(this.pBullets[u].type==="water"){this.damagemult=1.5}else if(this.pBullets[u].type==="rock"){this.damagemult=1}}if(this.pBullets[u].alive&&collision(this,this.pBullets[u])&&this.health>0){this.health-=wepTraits[Options.wepType].damage*this.damagemult;if(Options.wepType==="air"){this.angle=Math.atan2(n,t)+Math.PI;this.x-=t*this.speed*30;this.y-=n*this.speed*30}this.pBullets[u].alive=false;var a=new Audio;a.src=jsfxr(sounds[this.type].hit);a.play();a.addEventListener("ended",function(){delete a},false)}else if(this.pBullets[u].alive&&collision(this,this.pBullets[u])){this.alive=false;enemiesKilled+=1;this.explode=1;var f=new Audio;f.src=jsfxr(sounds[this.type].death);f.play();f.addEventListener("ended",function(){delete f},false)}}}};Enemy.prototype.draw=function(e,t){if(this.alive){e.save();e.translate(this.x,this.y);e.rotate(this.rotation);if(this.isboss){e.drawImage(enemyTraits[this.type].img,-6,-6,36,36)}else{e.drawImage(enemyTraits[this.type].img,-6,-6)}e.restore()}else if(this.explode){e.save();e.translate(this.x,this.y);e.rotate(this.rotation);if(this.isboss){e.drawImage(enemyTraits[this.type].boom,-6,-6,48,48)}else{e.drawImage(enemyTraits[this.type].boom,-6,-6,28,28)}e.restore();this.explode=(this.explode+1)%7}else if(!this.alive&&!this.boom){var n=t.indexOf(this);t.splice(n,1)}};Turret=function(e,t,n,r,i){this.x=e;this.y=t;this.speed=200;this.health=500;this.shield=200;this.direction=0;this.name=n;this.dmgcount=0;this.radius=40;this.eArrays=r;this.eBullets=i;this.alive=true;this.regen=false};Turret.prototype.checkCollision=function(e){for(var t=0;t<e.length;t++){if(e[t].alive&&collision(this,e[t])){if(this.shield>0){this.shield-=enemyTraits[Options.planType].damage;if(!this.regen){this.dmgcount=120}var n=new Audio;n.src=jsfxr(sounds.player.hit);n.play();n.addEventListener("ended",function(){delete n},false)}else if(this.shield<=0&&this.health>0){this.health-=enemyTraits[Options.planType].damage;var n=new Audio;n.src=jsfxr(sounds.player.hit);n.play();n.addEventListener("ended",function(){delete n},false)}else if(this.shield<=0&&this.health<=0){this.health-=enemyTraits[Options.planType].damage;var r=new Audio;r.src=jsfxr(sounds.player.death);r.play();r.addEventListener("ended",function(){delete r},false)}if(e[t].name==="bullet"){e[t].alive=false}}}};Turret.prototype.update=function(e,t){if(65 in keysDown){if(this.x>0){this.x-=this.speed*e}else{this.x=t.width}}if(87 in keysDown){if(this.y>0){this.y-=this.speed*e}else{this.y=t.height}}if(68 in keysDown){if(this.x<t.width){this.x+=this.speed*e}else{this.x=0}}if(83 in keysDown){if(this.y<t.height){this.y+=this.speed*e}else{this.y=0}}var n=this.findDirection(mouseX,mouseY);for(var r=0;r<this.eArrays.length;r++){this.checkCollision(this.eArrays[r])}this.checkCollision(this.eBullets);if(this.dmgcount>0){this.dmgcount--}if(this.shield<200&&this.shield>=0&&this.dmgcount==0){this.shield+=.25;this.regen=false}if(this.shield>0){this.radius=40}if(this.shield<=0){this.radius=10}if(this.shield<0){this.shield=0;this.dmgcount=540;this.regen=true}if(this.health<0){this.health=0;this.alive=false}this.direction+=n};Turret.prototype.draw=function(e){if(this.alive){e.save();e.translate(this.x,this.y);e.rotate(this.direction);var t="#";for(var n=0;n<3;n++){t+=(Math.floor(Math.random()*200)+55).toString(16)}e.beginPath();e.arc(0,0,40,0,2*Math.PI,false);e.lineWidth=4;e.strokeStyle=t;if(this.shield>0){e.stroke()}e.closePath();e.drawImage(sprite_player,-12,-12);e.restore()}};Turret.prototype.findDirection=function(e,t){var n=this.x-e;var r=this.y-t;var i=Math.atan2(r,n);var s=i-this.direction;return s};Planet=function(e,t,n,r,i,s){this.x=e;this.y=t;this.health=5e3;this.shield=3e3;this.name=n;this.radius=100;this.color=r;this.bullets=s;this.stroke=i;this.alive=true;this.damagemult=1;this.totaldamage=0;this.dmgcount=0;this.regen=false};Planet.prototype.update=function(){for(var e=0;e<this.bullets.length;e++){if(this.type==="fire"){if(this.pBullets[e].type==="fire"){this.damagemult=1}else if(this.pBullets[e].type==="air"){this.damagemult=1.5}else if(this.pBullets[e].type==="water"){this.damagemult=.5}else if(this.pBullets[e].type==="rock"){this.damagemult=1}}else if(this.type==="air"){if(this.pBullets[e].type==="fire"){this.damagemult=.5}else if(this.pBullets[e].type==="air"){this.damagemult=1}else if(this.pBullets[e].type==="water"){this.damagemult=1}else if(this.pBullets[e].type==="rock"){this.damagemult=1.5}}else if(this.type==="water"){if(this.pBullets[e].type==="fire"){this.damagemult=1.5}else if(this.pBullets[e].type==="air"){this.damagemult=1}else if(this.pBullets[e].type==="water"){this.damagemult=1}else if(this.pBullets[e].type==="rock"){this.damagemult=.5}}else if(this.type==="rock"){if(this.pBullets[e].type==="fire"){this.damagemult=1}else if(this.pBullets[e].type==="air"){this.damagemult=.5}else if(this.pBullets[e].type==="water"){this.damagemult=1.5}else if(this.pBullets[e].type==="rock"){this.damagemult=1}}if(this.bullets[e].alive&&collision(this,this.bullets[e])&&this.shield>0){this.shield-=wepTraits[Options.wepType].damage*this.damagemult;this.totaldamage+=wepTraits[Options.wepType].damage*this.damagemult;if(!this.regen){this.dmgcount=180}this.bullets[e].alive=false;var t=new Audio;t.src=jsfxr(sounds.planet.hit);t.play();t.addEventListener("ended",function(){delete t},false)}else if(this.bullets[e].alive&&collision(this,this.bullets[e])&&this.health>0){this.radius=70;this.health-=wepTraits[Options.wepType].damage*this.damagemult;this.totaldamage+=wepTraits[Options.wepType].damage*this.damagemult;this.bullets[e].alive=false;var t=new Audio;t.src=jsfxr(sounds.planet.hit);t.play();t.addEventListener("ended",function(){delete t},false)}else if(this.bullets[e].alive&&collision(this,this.bullets[e])){this.bullets[e].alive=false;this.alive=false;var n=new Audio;n.src=jsfxr(sounds.planet.death);n.play();n.addEventListener("ended",function(){delete n},false)}}if(this.dmgcount>0){this.dmgcount--}if(this.shield<3e3&&this.shield>=0&&this.dmgcount==0){this.shield+=.25;this.regen=false}if(this.shield>0){this.radius=135}if(this.shield<=0){this.radius=70}if(this.shield<0){this.shield=0;this.dmgcount=1500;this.regen=true}if(this.health<=0){this.health=0;this.alive=true}};Planet.prototype.draw=function(e){if(this.alive){e.beginPath();e.arc(this.x,this.y,70,0,2*Math.PI,false);e.fillStyle=this.color;e.fill();e.lineWidth=5;e.strokeStyle=this.stroke;e.stroke();var t="#";for(var n=0;n<3;n++){t+=(Math.floor(Math.random()*200)+55).toString(16)}e.beginPath();e.arc(this.x,this.y,135,0,2*Math.PI,false);e.lineWidth=7;e.strokeStyle=t;if(this.shield>0){e.stroke()}e.closePath()}};Star=function(e,t,n){this.x=e;this.y=t;this.color=n};Star.prototype.draw=function(e){e.beginPath();e.arc(this.x,this.y,1,0,2*Math.PI,false);e.fillStyle=this.color;e.fill()};Healthbar=function(e,t,n,r){this.x=e;this.y=t;this.owner=n;this.maxhealth=n.health;this.health=n.health;this.healthpercent=1;this.name=n.name;this.playsound=true;this.ismini=r;this.alive=true;if(n.shield){this.maxshield=n.shield;this.shield=n.shield;this.shieldpercent=1}};Healthbar.prototype.update=function(){this.health=this.owner.health;this.healthpercent=this.health/this.maxhealth;this.alive=this.owner.alive;if(this.shield!==false&&this.owner.shield!==false){this.shield=this.owner.shield;this.shieldpercent=this.shield/this.maxshield}if(!this.alive){delete this}};Healthbar.prototype.draw=function(e){if(this.alive){e.beginPath();e.fillStyle="red";if(this.ismini){e.fillRect(this.owner.x-55,this.owner.y-45,100*this.healthpercent,5)}else{e.fillRect(this.x,this.y,300*this.healthpercent,20)}e.font="12pt Arial";e.fillStyle="white";e.textAlign="center";if(!this.ismini){e.fillText(this.name,this.x+150,this.y+15)}if(this.shield>0){e.fillStyle="blue";if(this.ismini){e.fillRect(this.owner.x-55,this.owner.y-35,100*this.shieldpercent,5)}else{e.fillRect(this.x,this.y+30,300*this.shieldpercent,20)}e.font="12pt Arial";e.fillStyle="white";e.textAlign="center";if(!this.ismini){e.fillText("Shields",this.x+150,this.y+45)}this.playsound=true}else if(this.shield===0){if(this.playsound){var t=new Audio;t.src=jsfxr(sounds.player.shielddown);t.play();t.addEventListener("ended",function(){delete t},false);this.playsound=false}e.fillStyle="white";e.font="12pt Arial";e.textAlign="center";if(!this.ismini){e.fillText("Shields down!",this.x+150,this.y+45)}}else if(this.shield<=0){e.fillStyle="white";e.font="12pt Arial";e.textAlign="center";if(!this.ismini){e.fillText("Shields down!",this.x+150,this.y+45)}}e.closePath()}};Bullet=function(e,t,n,r,i,s,o,u,a,f,l){this.x=e;this.y=t;this.radius=n;this.dx=r;this.dy=i;this.speed=s;this.damage=o;this.name="bullet";this.color=u;this.birth=Date.now();this.alive=true;this.owner=f;this.playershot=l;this.rotation=0;this.penetratecount=0;this.currentenemy=0;this.penetrate=false;this.type=a;if(this.type==="rock"&&this.playershot){this.penetrate=true;this.radius=4}};Bullet.prototype.update=function(e){if(this.alive){if(this.x<0||this.x>winwidth||this.y<0||this.y>winheight){this.alive=false;var t=e.indexOf(this);e.splice(t,1)}else{this.x+=this.speed*this.dx;this.y+=this.speed*this.dy}if(this.type==="fire"&&distance(this.x,this.y,this.owner.x,this.owner.y)>150&&this.playershot){this.alive=false;var t=e.indexOf(this);e.splice(t,1)}if(this.penetratecount>3){this.alive=false;var t=e.indexOf(this);e.splice(t,1)}}};Bullet.prototype.draw=function(e){if(this.alive){e.save();e.translate(this.x,this.y);e.beginPath();e.fillStyle=this.color;e.arc(0,0,this.radius,0,2*Math.PI);e.fill();e.restore()}};Powerup=function(e,t,n,r){this.x=e;this.y=t;this.type=n;this.name="powerup";this.color="white";if(this.type==="tri"){this.name="TRISHOT";this.color="white"}else if(this.type==="fast"){this.name="FASTSHOT";this.color="red"}else if(this.type==="splash"){this.name="SPLASHSHOT";this.color="blue"}else if(this.type==="penetrate"){this.name="PENETRATE";this.color="brown"}else if(this.type==="health"){this.name="HEALTH";this.color="maroon"}else if(this.type==="invincibility"){this.name="INVINCIBILITY";this.color="gold"}this.radius=30;this.player=r;this.alive=true};Powerup.prototype.update=function(){if(this.alive){this.x+=5;this.y+=6}};Powerup.prototype.draw=function(e){if(this.alive){e.save();e.translate(this.x,this.y);e.beginPath();e.fillStyle=this.color;e.arc(0,0,this.radius,0,2*Math.PI);e.fill();e.font="12pt Arial";e.textAlign="center";e.fillText(this.name,this.x,this.y+15);e.restore()}}</script><style>canvas{position: absolute;cursor: none;}</style></head><body onload="initMainMenu()" onresize="resize()" onorientationchange="resize()" style="margin: 0;padding: 0;background-color: black;overflow: hidden;"><canvas id="stars" style="position: absolute"></canvas><canvas id="mainmenu" style="position: absolute"></canvas><canvas id="levelselect" style="position: absolute"></canvas></body></html>